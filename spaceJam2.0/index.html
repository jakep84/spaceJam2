
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport"
          content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
    <title>Hello World!</title>
    <script src="jquery-1.12.4.min.js"></script>
    <script src="../Build/Cesium/Cesium.js"></script>
    <style type="text/css">
        @import url(../Build/Cesium/Widgets/widgets.css);

        html, body, #cesiumContainer {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
        }

        .toolbar-left {
            display: block;
            position: absolute;
            top: 5px;
            left: 5px;
        }
    </style>
</head>
<body>
<div id="cesiumContainer"></div>
<div id="loadingOverlay"><h1>Welcome to spaceJam</h1></div>
<div class="toolbar-left">
<!-- <button id='MQ-9' onclick="">View MQ-9</button>
<button id='threat' onclick="alert('You clicked threat!');">View Threat</button> -->
<button id='fire' onclick="fire();">Fire AGM-114</button>
</div>
<script>
function foobar(){
  alert('click');
}
Cesium.BingMapsApi.defaultKey = 'lCTZtg5mZdx8IqETpNu0~1mCU8hrQlgW6QZ4Wd8SdWQ~AnDBosGQEY5KZIk9B_PxLxfYYv61p3ZcYrHeacJ3gGoAwIZ8Chkc-mllvOrOUXJj';
var terrainModels = Cesium.createDefaultTerrainProviderViewModels();
// Construct the viewer, with a high-res terrain source pre-selected.
var viewer = new Cesium.Viewer('cesiumContainer', {
    terrainProviderViewModels: terrainModels,
    selectedTerrainProviderViewModel: terrainModels[1]  // Select STK High-res terrain
});
//Create instance the of the veiwer
var scene = viewer.scene;
// Get a reference to the ellipsoid, with terrain on it.  (This API may change soon)
var ellipsoid = viewer.scene.globe.ellipsoid;
// Specify our point of interest.
var pointOfInterest = Cesium.Cartographic.fromDegrees(
    -112.729, 36.10883,6500, new Cesium.Cartographic());
var enemyLocation = Cesium.Cartographic.fromDegrees(
    -112.6595, 36.10883,1326, new Cesium.Cartographic());

// [OPTIONAL] Fly the camera there, to see if we got the right point.
viewer.camera.flyTo({
        // destiation : ellipsoid.cartographicToCartesian(enemyLocation,
        //     new Cesium.Cartesian3()),
        destination: ellipsoid.cartographicToCartesian(pointOfInterest,
            new Cesium.Cartesian3())
});
// Sample the terrain (async) and write the answer to the console.
Cesium.sampleTerrain(viewer.terrainProvider, 9, [ pointOfInterest ])
.then(function(samples) {
    console.log('Height in meters is: ' + samples[0].height);
});
////Enable depth testing so things behind the terrain disappear.
viewer.scene.globe.depthTestAgainstTerrain = true;
//Position the target object
var modelMatrix = Cesium.Transforms.eastNorthUpToFixedFrame(
    Cesium.Cartesian3.fromDegrees(-112.6595, 36.10883,1226));
//Create target object
var model = scene.primitives.add(Cesium.Model.fromGltf({
    //Name it for the info box
    name :'Threat',
    //Make the target a target apc
    url : '/spaceJam2.0/Cesium_Ground.glb',
    //Position the target object (I could use modelMatrix for positioning of all objects ( except firing location ) )
    modelMatrix : modelMatrix,
    //Size of the vehicle
    scale : 1.0,
    //direction of the apc
    heading : 20,
}));
//Build mq9 matrix
var mq9Matrix = Cesium.Transforms.eastNorthUpToFixedFrame(
    Cesium.Cartesian3.fromDegrees(-112.729, 36.10883,6400));
//Create target object
var model = scene.primitives.add(Cesium.Model.fromGltf({
    //Name it for the info box
    name :'Threat',
    //Make the target a target apc
    url : '/spaceJam2.0/mq9.glb',
    //Position the target object (I could use modelMatrix for positioning of all objects ( except firing location ) )
    modelMatrix : mq9Matrix,
    //Size of the vehicle
    scale : 1.0,
    //direction of the apc
    heading : 20,
}));
//Create visible 8km Maximum effective range ellipse
var maxEffectiveRange = viewer.entities.add({
  //Name it for the info box
  name: 'Maximum Effective Range',
  //Position the ring
  position : Cesium.Cartesian3.fromDegrees(-112.6595, 36.10883, 3000),
  //Create the actual max effective range ellipse
  ellipse : {
    //Size the ellipse
    semiMinorAxis : 8000.0,
    semiMajorAxis : 8000.0,
    //Give it no interior color (maybe later after drop pins//set target pin//choose fire location (turns the inside of the ellipse transparent green for better visual of firing location area on cloase up))
      fill : false,
      //Give it an outline
      outline : true,
      //Make it a wall for better visibility
      height:2000,
      //Color the outline red
      outlineColor : Cesium.Color.GREEN,
      //Size the outline
      outlineWidth : 4.0,
  }
});
//Create visible 20m blast radius
var blastRadius = viewer.entities.add({
    //Name it blast radius for the info box
    name : 'Blast Radius',
    //Describe it for the info box
    description: '',
    //Postion it using geodesic grid coordinates
    position : Cesium.Cartesian3.fromDegrees(-112.6595, 36.10883,1227),
    //Create the actual blast radius ellipsiod
    ellipsoid : {
        //Size it
        radii : new Cesium.Cartesian3(20.0, 20.0, 20.0),
        //Give it a clear transparent gridded skin
        material : new Cesium.GridMaterialProperty({
        //Color the grid yellow
        color : Cesium.Color.YELLOW,
        //Make the skin tranparent
        cellAlpha : 0.2,
        //Amount of lines in the grid
        lineCount : new Cesium.Cartesian2(8, 8),
        //Thickness of the lines
        lineThickness : new Cesium.Cartesian2(2.0, 2.0),
         }
    )}
});
//Create visible 20m kill radius object
var killRadius = viewer.entities.add({
    //Name it for the info box
    name : 'Kill Radius',
    //Describe it for the info box
    description: '<iframe width="400" height="300" src="https://www.youtube.com/embed/-zVybabPTy4" frameborder="0" allowfullscreen></iframe>',
    //postition it using it's give cartesian coordinates
    position : Cesium.Cartesian3.fromDegrees(-112.6595, 36.10883,1227),
    //create the actual blast radius ellipsoid
    ellipsoid : {
        //Size it (x,y,z)
        radii : new Cesium.Cartesian3(15.0, 15.0, 15.0),
        //Give it a transparent red skin
        material : Cesium.Color.RED.withAlpha(0.5),
        //Give it an outline for better visual of kill radius
        outline : true,
        //Color the outline black
        outlineColor : Cesium.Color.BLACK,
    }
    });
//Add button to veiw target area
Cesium.addToolbarButton('View Threat', function() {
    viewer.trackedEntity = killRadius;
});
// //build matrix for weapons platform
// function createModel() {
//     var position = Cesium.Cartesian3.fromDegrees(-112.729, 36.10883, height);
//     var heading = Cesium.Math.toRadians(270);
//     var pitch = 0;
//     var roll = 0;
//     var orientation = Cesium.Transforms.headingPitchRollQuaternion(position, heading, pitch, roll);
//     var entity = viewer.entities.add({
//         name : url,
//         position : position,
//         orientation : orientation,
//         height : 6400.0,
//         model : {
//             uri : '/spaceJam2.0/mq9.glb',
//             //minimumPixelSize : 128,
//             scale : 1
//         }
//     });
//     viewer.trackedEntity = entity;
// }
// //Give option for MQ-9 or AH-64
// var options = [
//     {text :'Choose Platform'
// },
//     {
//     text : 'MQ-9',
//     onselect : function() {
//         createModel('/spaceJam2.0/mq9.glb', 6400.0);
//     },
// },{
//     text : 'AH-64(Inactive)',
//     onselect : function() {
//         createModel('/spaceJam2.0/ah64.glb', 6400.0);
//     },
// }
// ];
// Cesium.addToolbarMenu(options);
//Position the target object
// var mq9Matrix = Cesium.Transforms.eastNorthUpToFixedFrame(
//     Cesium.Cartesian3.fromDegrees(-112.729, 36.10883,6400));
// //Create target object
// var model = scene.primitives.add(Cesium.Model.fromGltf({
//     //Name it for the info box
//     name :'Threat',
//     //Make the target a target apc
//     url : '/spaceJam2.0/mq9.glb',
//     //Position the target object (I could use modelMatrix for positioning of all objects ( except firing location ) )
//     modelMatrix : mq9Matrix,
//     //Size of the vehicle
//     scale : 1.0,
//     //direction of the apc
//     heading : 20,
// }));

function fire() {
  alert("works");
    viewer.dataSources.add(Cesium.CzmlDataSource.load('/spaceJam2.0/agmLaunch.czml'));

    viewer.scene.camera.setView({
        destination:  Cesium.Cartesian3.fromDegrees( -112.7295, 36.10873, 8000),
        orientation: {
            heading: 6,
            picth: -Cesium.Math.PI_OVER_TWO
        }
    });
};
// Cesium.addToolbarButton('Fire AGM-114',fire);
// Add button to fire AH64
// Cesium.addToolbarButton('Fire AGM-114', function() {
//     viewer.dataSources.add(Cesium.CzmlDataSource.load('/sjc/agmLaunch.czml'));
//
//     viewer.scene.camera.setView({
//         destination:  Cesium.Cartesian3.fromDegrees( -112.7295, 36.10883, 8000),
//         orientation: {
//             heading: 6,
//             picth: -Cesium.Math.PI_OVER_TWO
//         }
//     });
// });
</script>

</body>
</html>
